/**
 * GAMIFICATION DESIGN SYSTEM
 * Adapted from PR #680 — oklch palette, Polar Night compatible
 */

/* ============================================
   Color Tokens
   ============================================ */

:root {
  /* XP — Vibrant Green */
  --gf-xp-color: oklch(0.68 0.16 142);
  --gf-xp-glow: oklch(0.68 0.16 142 / 0.4);
  --gf-xp-bg: oklch(0.68 0.16 142 / 0.08);

  /* Streaks — Amber */
  --gf-streak-color: oklch(0.77 0.16 77);
  --gf-streak-glow: oklch(0.77 0.16 77 / 0.4);
  --gf-streak-bg: oklch(0.77 0.16 77 / 0.08);

  /* Rank — Teal */
  --gf-rank-color: oklch(0.72 0.16 145);
  --gf-rank-glow: oklch(0.72 0.16 145 / 0.4);
  --gf-rank-bg: oklch(0.72 0.16 145 / 0.08);

  /* Perfect — Gold */
  --gf-perfect-color: oklch(0.8 0.16 85);
  --gf-perfect-glow: oklch(0.8 0.16 85 / 0.4);
  --gf-perfect-bg: oklch(0.8 0.16 85 / 0.08);

  /* Leaderboard rank medals */
  --gf-gold: oklch(0.77 0.16 70);
  --gf-gold-glow: oklch(0.77 0.16 70 / 0.5);
  --gf-silver: oklch(0.75 0.02 260);
  --gf-silver-glow: oklch(0.75 0.02 260 / 0.4);
  --gf-bronze: oklch(0.6 0.1 50);
  --gf-bronze-glow: oklch(0.6 0.1 50 / 0.4);

  /* Badges */
  --gf-badge-earned: oklch(0.72 0.18 265);
  --gf-badge-locked: oklch(0.55 0 0);
  --gf-badge-locked-bg: oklch(0.55 0 0 / 0.08);

  /* Cards */
  --gf-card-bg: var(--ifm-color-emphasis-100);
  --gf-card-border: var(--ifm-color-emphasis-200);
  --gf-card-radius: 12px;

  /* Progress bar */
  --gf-bar-track: var(--ifm-color-emphasis-200);
  --gf-bar-fill: var(--gf-xp-color);
}

[data-theme="dark"] {
  --gf-xp-color: oklch(0.72 0.18 142);
  --gf-xp-glow: oklch(0.72 0.18 142 / 0.5);
  --gf-xp-bg: oklch(0.72 0.18 142 / 0.1);

  --gf-streak-color: oklch(0.8 0.18 77);
  --gf-streak-glow: oklch(0.8 0.18 77 / 0.5);
  --gf-streak-bg: oklch(0.8 0.18 77 / 0.1);

  --gf-gold: oklch(0.82 0.18 70);
  --gf-gold-glow: oklch(0.82 0.18 70 / 0.6);
  --gf-silver: oklch(0.8 0.03 260);
  --gf-silver-glow: oklch(0.8 0.03 260 / 0.5);
  --gf-bronze: oklch(0.65 0.12 50);
  --gf-bronze-glow: oklch(0.65 0.12 50 / 0.5);

  --gf-perfect-color: oklch(0.72 0.2 300);
  --gf-perfect-glow: oklch(0.72 0.2 300 / 0.5);

  --gf-card-bg: oklch(0.25 0.01 260);
  --gf-card-border: oklch(0.32 0.01 260);
}

/* ============================================
   Animations
   ============================================ */

@keyframes gf-xp-pulse {
  0%, 100% { box-shadow: 0 0 0 0 var(--gf-xp-glow); }
  50% { box-shadow: 0 0 12px 4px var(--gf-xp-glow); }
}

@keyframes gf-count-up {
  0% { transform: translateY(8px); opacity: 0; }
  100% { transform: translateY(0); opacity: 1; }
}

@keyframes gf-badge-unlock {
  0% { transform: scale(0.5); opacity: 0; }
  50% { transform: scale(1.15); }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes gf-badge-glow {
  0%, 100% { filter: drop-shadow(0 0 0 transparent); }
  50% { filter: drop-shadow(0 0 8px var(--gf-badge-earned)); }
}

@keyframes gf-row-enter {
  0% { background-color: var(--gf-xp-bg); opacity: 0.6; }
  100% { background-color: transparent; opacity: 1; }
}

@keyframes gf-score-reveal {
  0% { transform: scale(0); opacity: 0; }
  60% { transform: scale(1.1); }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes gf-xp-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

@keyframes gf-flame-flicker {
  0%, 100% { transform: scaleY(1) scaleX(1); filter: brightness(1); }
  25% { transform: scaleY(1.05) scaleX(0.95); filter: brightness(1.1); }
  50% { transform: scaleY(0.95) scaleX(1.05); filter: brightness(0.95); }
  75% { transform: scaleY(1.02) scaleX(0.98); filter: brightness(1.05); }
}

@keyframes gf-progress-scan {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(200%); }
}

/* ============================================
   Stat Card Glow Effects (used by ProgressDashboard)
   ============================================ */

.gf-stat-xp {
  border-color: var(--gf-xp-color);
  box-shadow: inset 0 0 20px -10px var(--gf-xp-glow);
  transition: box-shadow 0.2s ease;
}
.gf-stat-xp:hover {
  box-shadow: inset 0 0 24px -8px var(--gf-xp-glow), 0 2px 8px -2px var(--gf-xp-glow);
}

.gf-stat-streak {
  border-color: var(--gf-streak-color);
  box-shadow: inset 0 0 20px -10px var(--gf-streak-glow);
  transition: box-shadow 0.2s ease;
}
.gf-stat-streak:hover {
  box-shadow: inset 0 0 24px -8px var(--gf-streak-glow), 0 2px 8px -2px var(--gf-streak-glow);
}

.gf-stat-rank {
  border-color: var(--gf-rank-color);
  box-shadow: inset 0 0 20px -10px var(--gf-rank-glow);
  transition: box-shadow 0.2s ease;
}
.gf-stat-rank:hover {
  box-shadow: inset 0 0 24px -8px var(--gf-rank-glow), 0 2px 8px -2px var(--gf-rank-glow);
}

.gf-stat-perfect {
  border-color: var(--gf-perfect-color);
  box-shadow: inset 0 0 20px -10px var(--gf-perfect-glow);
  transition: box-shadow 0.2s ease;
}
.gf-stat-perfect:hover {
  box-shadow: inset 0 0 24px -8px var(--gf-perfect-glow), 0 2px 8px -2px var(--gf-perfect-glow);
}

/* ============================================
   Leaderboard Rank Badges
   ============================================ */

.gf-rank-gold {
  background: linear-gradient(135deg, var(--gf-gold), oklch(0.7 0.14 70));
  box-shadow: 0 0 8px var(--gf-gold-glow);
  color: oklch(0.2 0.02 70);
}

.gf-rank-silver {
  background: linear-gradient(135deg, var(--gf-silver), oklch(0.65 0.02 260));
  box-shadow: 0 0 8px var(--gf-silver-glow);
  color: oklch(0.2 0.01 260);
}

.gf-rank-bronze {
  background: linear-gradient(135deg, var(--gf-bronze), oklch(0.5 0.08 50));
  box-shadow: 0 0 8px var(--gf-bronze-glow);
  color: oklch(0.2 0.05 50);
}

/* ============================================
   Streak Flame Effect
   ============================================ */

.gf-streak-flame {
  animation: gf-flame-flicker 1.5s ease-in-out infinite;
  color: var(--gf-streak-color);
  text-shadow: 0 0 8px var(--gf-streak-glow);
}

/* ============================================
   Progress Bar Scan Effect
   ============================================ */

.gf-bar-animated {
  position: relative;
  overflow: hidden;
}

.gf-bar-animated::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent 0%, oklch(1 0 0 / 0.15) 50%, transparent 100%);
  animation: gf-progress-scan 2s ease-in-out infinite;
}

/* ============================================
   QuizXPModal Animation Classes
   ============================================ */

.score-circle-reveal {
  animation: gf-score-reveal 0.6s ease-out 0.2s both;
}

.xp-earned-bounce {
  animation: gf-xp-bounce 0.5s ease-out 0.6s both;
}

/* ============================================
   BadgeCard Glow Effect
   ============================================ */

.badge-earned-glow {
  animation: gf-badge-glow 2s ease-in-out infinite;
}

/* ============================================
   Leaderboard Rank Badges (Tailwind components)
   ============================================ */

.rank-badge-gold {
  background: linear-gradient(135deg, var(--gf-gold), oklch(0.65 0.14 70));
  box-shadow: 0 0 12px var(--gf-gold-glow);
  border-radius: 9999px !important;
}

.rank-badge-silver {
  background: linear-gradient(135deg, var(--gf-silver), oklch(0.6 0.02 260));
  box-shadow: 0 0 10px var(--gf-silver-glow);
  border-radius: 9999px !important;
}

.rank-badge-bronze {
  background: linear-gradient(135deg, var(--gf-bronze), oklch(0.45 0.08 50));
  box-shadow: 0 0 8px var(--gf-bronze-glow);
  border-radius: 9999px !important;
}

/* ============================================
   Your Rank Highlight
   ============================================ */

.your-rank-highlight {
  background: var(--gf-xp-bg);
}
